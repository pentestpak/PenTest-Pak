#!/bin/python 

import socketserver
from pwn import process

class Handler(socketserver.BaseRequestHandler):
    def handle(self):
        p = process('./format')
        
        #Send banner through socket
        self.request.sendall(p.recv())

        #Recieve exploit through socket
        response = self.request.recv(1024)
        print(response)
        #Send exploit to process
        p.sendline(response)
        
        #Get Responses from server
        self.request.sendall(p.recvuntil('stuff...\n'))
        self.request.sendall(p.recv())
        self.request.sendall(p.recv())
        #p.interactive()
        




if __name__ == '__main__':
    HOST,PORT = '0.0.0.0',2456

    #Create Server

    with socketserver.TCPServer((HOST,PORT), Handler) as server:
        server.serve_forever()

